<div class="container">
  <div class="row">
    <div class="col mx-auto">

      <!--見出し-->
      <div class="row pt-5 pb-3">
        <div class="col-5">
        <h3>
          <%= @schedule.created_at.strftime('%m月%d日') %>
          <%= @schedule.nurse.name %> さんのスケジュール
        </h3>

        </div>
        <div class="col-5">
        <!--プルダウンで看護師名を選択して切替を押下すると、該当看護師の当日分のスケジュールshowページでへ遷移する-->
          <%= form_with url: schedule_path do |f| %>
              <%= f.collection_select :nurse_id, @nurses, :id, :name %>
              <%= f.submit "表示スケジュールの切り替え", class: "btn-sm btn-secondary" %>
          <% end %>
        </div>
      </div>


      <!--スケジュール表示-->
      <%= render 'schedule', task_lists: @task_lists, task_list: @task_list, schedule: @schedule %>

     <!--レビュー投稿と表示画面への遷移リンク -->
      <div class="row p-4 mt-5 shadow">
        <div class="col-8">
          <%= form_with model:[@schedule,@review], local:true do |f| %>
          <div class="form-group row p-1">
            <div class="col-9">
              <%= f.label :review do %><i class="fas fa-user-edit"></i>レビューをする<% end %>
              <%= f.text_area :review, class: "form-control" %>
            </div>
            <div class="col-3 align-self-end">
            <!--reviewer_nurse_は投稿をした看護師。投稿される看護師はscheduleに紐づいている(nurse_id)-->
              <%= f.hidden_field :reviewer_nurse_id, value: current_nurse.id %>
              <%= f.hidden_field :schedule_id, value: @schedule.id %>
              <%= f.submit "投稿", class: "btn btn-dark btn-sm col-3" %>
            </div>
          </div>
          <% end %>
        </div>
        <div class="col-4 align-self-end">
          <%= link_to schedule_reviews_path(@schedule), class: "body_link" do %>
            他のレビューをみる
          <% end %>
        </div>
      </div>


      </div>

      <!--スケジュールを削除する（タスクもすべて削除される）。ログインユーザーにのみ表示される。-->
      <% if @schedule.nurse_id == current_nurse.id %>
      <div class="row p-3">
        <div class="col-5">
          <%= link_to schedule_path(@schedule.id), method: :delete, class: 'body_link' do %>
            <%= @schedule.created_at.strftime('%m月%d日') %>のスケジュールを削除する
          <% end %>
        </div>
        <p class="small">実行後、こちらのスケジュール関連するタスクとレビューがすべて削除されます。</p>
      </div>
      <% end %>

    </div>
  </div>
</div>